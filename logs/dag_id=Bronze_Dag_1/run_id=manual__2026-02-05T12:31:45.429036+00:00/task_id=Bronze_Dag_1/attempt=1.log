[2026-02-05T12:31:46.634+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2026-02-05T12:31:46.671+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Bronze_Dag_1.Bronze_Dag_1 manual__2026-02-05T12:31:45.429036+00:00 [queued]>
[2026-02-05T12:31:46.686+0000] {taskinstance.py:2613} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Bronze_Dag_1.Bronze_Dag_1 manual__2026-02-05T12:31:45.429036+00:00 [queued]>
[2026-02-05T12:31:46.687+0000] {taskinstance.py:2866} INFO - Starting attempt 1 of 1
[2026-02-05T12:31:46.716+0000] {taskinstance.py:2889} INFO - Executing <Task(PythonOperator): Bronze_Dag_1> on 2026-02-05 12:31:45.429036+00:00
[2026-02-05T12:31:46.735+0000] {warnings.py:112} WARNING - /home/airflow/.local/lib/python3.12/site-packages/airflow/task/task_runner/standard_task_runner.py:70: DeprecationWarning: This process (pid=11576) is multi-threaded, use of fork() may lead to deadlocks in the child.
  pid = os.fork()

[2026-02-05T12:31:46.739+0000] {standard_task_runner.py:72} INFO - Started process 11577 to run task
[2026-02-05T12:31:46.748+0000] {standard_task_runner.py:104} INFO - Running: ['airflow', 'tasks', 'run', 'Bronze_Dag_1', 'Bronze_Dag_1', 'manual__2026-02-05T12:31:45.429036+00:00', '--job-id', '1292', '--raw', '--subdir', 'DAGS_FOLDER/bronze_dag_1.py', '--cfg-path', '/tmp/tmpxa54yznu']
[2026-02-05T12:31:46.750+0000] {standard_task_runner.py:105} INFO - Job 1292: Subtask Bronze_Dag_1
[2026-02-05T12:31:46.875+0000] {task_command.py:467} INFO - Running <TaskInstance: Bronze_Dag_1.Bronze_Dag_1 manual__2026-02-05T12:31:45.429036+00:00 [running]> on host eff5ec4100e1
[2026-02-05T12:31:47.070+0000] {taskinstance.py:3132} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='Bronze_Dag_1' AIRFLOW_CTX_TASK_ID='Bronze_Dag_1' AIRFLOW_CTX_EXECUTION_DATE='2026-02-05T12:31:45.429036+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2026-02-05T12:31:45.429036+00:00'
[2026-02-05T12:31:47.071+0000] {taskinstance.py:731} INFO - ::endgroup::
[2026-02-05T12:31:47.094+0000] {logging_mixin.py:190} INFO - RunId for this task instance: manual__2026-02-05T12:31:45.429036+00:00
[2026-02-05T12:33:19.436+0000] {python.py:240} INFO - Done. Returned value was: :: loading settings :: url = jar:file:/opt/spark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Raw sys.argv: ['/opt/airflow/RedPluto-Data-Engineering-Tool/main_bronze.py', 'manual__2026-02-05T12:31:45.429036+00:00', '{"user": "rpdet_az", "password": "***", "config_db": "config_db", "config_table": "config_table", "application_config": "application_config", "audit_table": "audit_table", "error_table": "error_table", "config_recon": "reconciliation_config", "data_dictionary_table": "data_dictionary_table", "recon_result": "recon_result", "DQ_config": "data_quality_config_table", "DQ_output": "data_quality_output_table", "url": "jdbc:postgresql://74.225.252.224:5432", "driver": "org.postgresql.Driver", "mysql_url": "jdbc:mysql://74.225.252.224:3306", "mysql_driver": "com.mysql.cj.jdbc.Driver", "reference_table": "reference_table", "log_path": "/opt/airflow/spark_logs", "dq_log_path": "/opt/airflow/data_quality_logs", "string_default": "NA", "int_default": 0, "date_default": "01/01/2099"}']
app_prop: {'user': 'rpdet_az', 'password': '***', 'config_db': 'config_db', 'config_table': 'config_table', 'application_config': 'application_config', 'audit_table': 'audit_table', 'error_table': 'error_table', 'config_recon': 'reconciliation_config', 'data_dictionary_table': 'data_dictionary_table', 'recon_result': 'recon_result', 'DQ_config': 'data_quality_config_table', 'DQ_output': 'data_quality_output_table', 'url': 'jdbc:postgresql://74.225.252.224:5432', 'driver': 'org.postgresql.Driver', 'mysql_url': 'jdbc:mysql://74.225.252.224:3306', 'mysql_driver': 'com.mysql.cj.jdbc.Driver', 'reference_table': 'reference_table', 'log_path': '/opt/airflow/spark_logs', 'dq_log_path': '/opt/airflow/data_quality_logs', 'string_default': 'NA', 'int_default': 0, 'date_default': '01/01/2099'}
2026-02-05 12:32:16,776 - INFO - Fetching config table
2026-02-05 12:32:25,907 - INFO - Fetching application config table
2026-02-05 12:32:26,557 - INFO - Enriching config data with target application name
2026-02-05 12:32:28,255 - INFO - Fetching Bronze Tables
+----------+---------------+-------------+-----------+--------------------+----------------+---------------------+------------------+--------------------+-----------+----------------+---------------------+------------------+----------------------+--------------------+----------------+--------------+---------------------+--------------------+-----------+------------------+---------------------+-----------+----------------------+--------------------+------------+-------------+--------------------+---------------------+---------------------+--------------------+--------------------+-----------------------+
|config_key|execution_layer|source_system|source_type|    source_file_path|source_file_name|source_file_delimiter|source_schema_name|   source_table_name|target_type|target_file_path|target_file_delimiter|target_schema_name|temporary_target_table|   target_table_name|       load_type|   primary_key|effective_date_column|         md5_columns|custom_code|execution_sequence|enable_dynamic_schema|active_flag|full_data_refresh_flag|source_connection_id|target_layer|target_system|target_connection_id|source_application_id|target_application_id|          created_at|          updated_at|target_application_name|
+----------+---------------+-------------+-----------+--------------------+----------------+---------------------+------------------+--------------------+-----------+----------------+---------------------+------------------+----------------------+--------------------+----------------+--------------+---------------------+--------------------+-----------+------------------+---------------------+-----------+----------------------+--------------------+------------+-------------+--------------------+---------------------+---------------------+--------------------+--------------------+-----------------------+
|         1|         bronze|        mysql|      table|                  NA|              NA|                    N|     insurance_sec|             Address|      table|              NA|                   NA|  insurance_bronze|                    NA|             address|incremental_load|     AddressID|         last_updated|                  NA|         NA|              None|                    Y|          N|                     N|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|         2|         bronze|        excel|       file|/opt/airflow/sour...|Benificiary.xlsx|                    N|                NA|                  NA|      table|              NA|                   NA|  insurance_bronze|                    NA|         beneficiary|incremental_load| BeneficiaryID|         last_updated|                  NA|         NA|              None|                    Y|          N|                     N|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|         3|         bronze|        mysql|      table|                  NA|              NA|                    N|     insurance_sec|               Claim|      table|              NA|                   NA|  insurance_bronze|                    NA|               claim|incremental_load|       ClaimID|         last_updated|                  NA|         NA|              None|                    Y|          N|                     N|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|         4|         bronze|      parquet|       file|/opt/airflow/sour...| contact.parquet|                    N|                NA|                  NA|      table|              NA|                   NA|            bronze|                    NA|             contact|incremental_load|     ContactID|         last_updated|                  NA|         NA|              None|                    Y|          N|                     N|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|         5|         bronze|        mysql|      table|                  NA|              NA|                    N|     insurance_sec|            Coverage|      table|              NA|                   NA|  insurance_bronze|                    NA|            coverage|incremental_load|    CoverageID|         last_updated|                  NA|         NA|              None|                    Y|          N|                     N|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|         6|         bronze|        mysql|      table|                  NA|              NA|                    N|     insurance_sec|            Customer|      table|              NA|                   NA|  insurance_bronze|                    NA|            customer|   truncate_load|    CustomerID|         last_updated|                  NA|         NA|              None|                    N|          N|                     N|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|         7|         bronze|        mysql|      table|                  NA|              NA|                    N|     insurance_sec|             Payment|      table|              NA|                   NA|  insurance_bronze|                    NA|             payment|   truncate_load|     PaymentID|         last_updated|                  NA|         NA|              None|                    Y|          N|                     N|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|         8|         bronze|        mysql|      table|                  NA|              NA|                    N|     insurance_sec|              Policy|      table|              NA|                   NA|  insurance_bronze|                    NA|              policy|   truncate_load|      PolicyID|         last_updated|                  NA|         NA|              None|                    Y|          N|                     N|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|         9|         bronze|          csv|       file|/opt/airflow/sour...|    Property.csv|                    N|                NA|                  NA|      table|              NA|                   NA|  insurance_bronze|                    NA|            property|incremental_load|    PropertyID|         last_updated|                  NA|         NA|              None|                    Y|          N|                     N|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|        10|         bronze|         json|       file|/opt/airflow/sour...|     mtcars.json|                    N|                NA|                  NA|      table|              NA|                   NA|            bronze|                    NA|              mtcars|   truncate_load|         model|                   NA|                  NA|         NA|              None|                    Y|          N|                     N|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|        27|         bronze|      parquet|       file|/opt/airflow/sour...| titanic.parquet|                    N|                NA|                  NA|      table|              NA|                   NA|            bronze|                    NA|             titanic|   truncate_load|   PassengerId|                   NA|                  NA|         NA|                NA|                    Y|          N|                     N|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|        30|         bronze|        mysql|      table|                  NA|              NA|                    N|           banking|           customers|      table|              NA|                   NA|    banking_bronze|                    NA|           customers|incremental_load|   customer_id|         last_updated|customer_id,first...|         NA|                NA|                    Y|          N|                     N|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|        33|         bronze|        mysql|      table|                  NA|              NA|                    N|           banking|        transactions|      table|              NA|                   NA|    banking_bronze|                    NA|        transactions|   truncate_load|transaction_id|         last_updated|transaction_id,ac...|         NA|                NA|                    Y|          N|                     Y|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|        37|         bronze|        mysql|      table|                  NA|              NA|                    N|    banking_bronze|           customers|      table|              NA|                   NA|    banking_silver|                    NA|           customers|   truncate_load|   customer_id|         last_updated|customer_id,first...|         NA|                NA|                    Y|          N|                     Y|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|        80|         bronze|        mysql|      table|                  NA|              NA|                   NA|         office_db|              assets|      table|              NA|                   NA|  office_db_bronze|                    NA|              assets|   truncate_load|      asset_id|         last_updated|                  NA|         NA|              None|                    Y|          N|                     N|                NULL|        NULL|         NULL|                NULL|                 NULL|                 NULL|2025-11-14 13:15:...|2025-11-14 13:15:...|                   NULL|
|      3018|         bronze|        mysql|      table|                  NA|              NA|                   NA|     school_source|          class_info|      table|              NA|                   NA|     school_bronze|                    NA|          class_info|   truncate_load|      class_id|             class_id|                  NA|         NA|                NA|                    N|          N|                     N|                   3|          NA|        mysql|                   3|                    5|                    5|2025-12-23 13:08:...|2026-01-20 09:54:...|           Student_Data|
|      3017|         bronze|        mysql|      table|                  NA|              NA|                   NA|     school_source|        teacher_info|      table|              NA|                   NA|     school_bronze|                    NA|        teacher_info|incremental_load|    teacher_id|           teacher_id|                  NA|         NA|                NA|                    N|          N|                     N|                   3|          NA|        mysql|                   3|                    5|                    5|2025-12-22 14:18:...|2025-12-23 05:26:...|           Student_Data|
|      3016|         bronze|        mysql|      table|                  NA|              NA|                   NA|     school_source|        student_info|      table|              NA|                   NA|     school_bronze|                    NA|        student_info|   truncate_load|    student_id|         last_updated|                  NA|         NA|                na|                    Y|          Y|                     N|                   3|          NA|        mysql|                   3|                    5|                    5|2025-11-20 10:24:...|2026-01-20 07:02:...|           Student_Data|
|      3026|         bronze|        mysql|      table|                  NA|              NA|                   NA|       finance_etl|fin_transactions_...|      table|              NA|                   NA|       finance_etl|                    NA|fin_transactions_...|   truncate_load|        txn_id|         last_updated|                  NA|         NA|                NA|                    Y|          N|                     N|                   4|          NA|        mysql|                   4|                    2|                    2|2026-01-26 11:04:...|2026-01-28 11:03:...|           HospitalData|
|      3023|         bronze|        mysql|      table|                  NA|              NA|                   NA|       finance_etl|fin_transactions_src|      table|              NA|                   NA|       finance_etl|                    NA|fin_transactions_...|   truncate_load|        txn_id|         last_updated|                  NA|         NA|                NA|                    N|          N|                     N|                   4|          NA|        mysql|                   4|                    2|                    2|2026-01-19 14:40:...|2026-01-22 09:26:...|           HospitalData|
+----------+---------------+-------------+-----------+--------------------+----------------+---------------------+------------------+--------------------+-----------+----------------+---------------------+------------------+----------------------+--------------------+----------------+--------------+---------------------+--------------------+-----------+------------------+---------------------+-----------+----------------------+--------------------+------------+-------------+--------------------+---------------------+---------------------+--------------------+--------------------+-----------------------+
only showing top 20 rows

2026-02-05 12:32:41,725 - INFO - Reading Config Table Arguments
2026-02-05 12:32:45,466 - INFO - Looping through Config Table Arguments Layer-Bronze
2026-02-05 12:32:45,468 - INFO - Checking for Null Values in Config Data
2026-02-05 12:32:45,469 - INFO - Validation Done for NULL check in Config Data
2026-02-05 12:32:45,469 - INFO - truncate_load,SourceTable = student_info.TargetTable = student_info
2026-02-05 12:32:45,469 - INFO - truncate_load,SourceTable = student_info.TargetTable = student_info
2026-02-05 12:32:45,470 - INFO - Calling Bronze TruncateLoad Function SourceTable - student_info,TargetTable -student_info
2026-02-05 12:32:45,470 - INFO - Calling Bronze TruncateLoad Function SourceTable - student_info,TargetTable -student_info
2026-02-05 12:32:45,470 - INFO - Calling Bronze TruncateLoad Function SourceTable - student_info,TargetTable -student_info
2026-02-05 12:32:45,470 - INFO - Fetching SQL Source and Target Data for TruncateLoad
2026-02-05 12:32:45,470 - INFO - Fetching SQL Source and Target Data for TruncateLoad
2026-02-05 12:32:45,470 - INFO - Reading SQL Source Data
2026-02-05 12:32:45,470 - INFO - Reading SQL Source Data
+----------+----------+---------+------+-------------+--------------------+---------+--------------+-------+-------------------+
|student_id|first_name|last_name|gender|date_of_birth|               email|     city|         state|country|       last_updated|
+----------+----------+---------+------+-------------+--------------------+---------+--------------+-------+-------------------+
|         1|     Aarav|   Sharma|  Male|   2010-05-14|aarav.sharma@exam...|     Pune|   Maharashtra|  India|2025-11-13 09:43:37|
|         2|      Diya|    Patel|Female|   2011-09-23|diya.patel@exampl...|Ahmedabad|       Gujarat|  India|2025-11-13 09:43:37|
|         3|     Rohan|    Verma|  Male|   2010-03-17|rohan.verma@examp...|    Delhi|         Delhi|  India|2025-11-13 09:43:37|
|         4|     Anaya|     Nair|Female|   2012-07-02|anaya.nair@exampl...|    Kochi|        Kerala|  India|2025-11-13 09:43:37|
|         5|    Vivaan|    Mehta|  Male|   2009-12-11|vivaan.mehta@exam...|   Mumbai|   Maharashtra|  India|2025-11-13 09:43:37|
|         6|      Isha|    Reddy|Female|   2011-02-25|isha.reddy@exampl...|Hyderabad|     Telangana|  India|2025-11-13 09:43:37|
|         7|     Kabir|    Singh|  Male|   2010-08-19|kabir.singh@examp...|   Jaipur|     Rajasthan|  India|2025-11-13 09:43:37|
|         8|     Rahul|    Joshi|  Male|   2010-04-21|rahul.joshi@examp...|   Nagpur|   Maharashtra|  India|2026-02-05 12:04:56|
|         9|     Sneha|    Gupta|Female|   2011-12-05|sneha.gupta@examp...|   Indore|Madhya Pradesh|  India|2026-02-05 12:04:56|
+----------+----------+---------+------+-------------+--------------------+---------+--------------+-------+-------------------+

2026-02-05 12:32:47,495 - INFO - Reading SQL Target Data
2026-02-05 12:32:47,495 - INFO - Reading SQL Target Data
+----------+----------+---------+------+-------------+--------------------+---------+-------+-------------------+-------------------+-------------------+--------------------+--------------------+
|student_id|first_name|last_name|gender|date_of_birth|               email|     city|country|       last_updated|        insert_date|        update_date|       insert_run_id|       update_run_id|
+----------+----------+---------+------+-------------+--------------------+---------+-------+-------------------+-------------------+-------------------+--------------------+--------------------+
|         1|     Aarav|   Sharma|  Male|   2010-05-14|aarav.sharma@exam...|     Pune|  India|2025-11-13 09:43:37|2025-11-20 10:24:59|2025-11-13 09:43:37|manual__2025-11-2...|manual__2025-11-2...|
|         2|      Diya|    Patel|Female|   2011-09-23|diya.patel@exampl...|Ahmedabad|  India|2025-11-13 09:43:37|2025-11-20 10:24:59|2025-11-13 09:43:37|manual__2025-11-2...|manual__2025-11-2...|
|         3|     Rohan|    Verma|  Male|   2010-03-17|rohan.verma@examp...|    Delhi|  India|2025-11-13 09:43:37|2025-11-20 10:24:59|2025-11-13 09:43:37|manual__2025-11-2...|manual__2025-11-2...|
|         4|     Anaya|     Nair|Female|   2012-07-02|anaya.nair@exampl...|    Kochi|  India|2025-11-13 09:43:37|2025-11-20 10:24:59|2025-11-13 09:43:37|manual__2025-11-2...|manual__2025-11-2...|
|         5|    Vivaan|    Mehta|  Male|   2009-12-11|vivaan.mehta@exam...|   Mumbai|  India|2025-11-13 09:43:37|2025-11-20 10:24:59|2025-11-13 09:43:37|manual__2025-11-2...|manual__2025-11-2...|
|         6|      Isha|    Reddy|Female|   2011-02-25|isha.reddy@exampl...|Hyderabad|  India|2025-11-13 09:43:37|2025-11-20 10:24:59|2025-11-13 09:43:37|manual__2025-11-2...|manual__2025-11-2...|
|         7|     Kabir|    Singh|  Male|   2010-08-19|kabir.singh@examp...|   Jaipur|  India|2025-11-13 09:43:37|2025-11-20 10:24:59|2025-11-13 09:43:37|manual__2025-11-2...|manual__2025-11-2...|
+----------+----------+---------+------+-------------+--------------------+---------+-------+-------------------+-------------------+-------------------+--------------------+--------------------+

2026-02-05 12:32:48,781 - INFO - Adding insert_date and update_date to source_data for Bronze layer
2026-02-05 12:32:48,781 - INFO - Adding insert_date and update_date to source_data for Bronze layer
2026-02-05 12:32:48,975 - INFO - Collected SQL Source and Target Data for TruncateLoad
2026-02-05 12:32:48,975 - INFO - Collected SQL Source and Target Data for TruncateLoad
2026-02-05 12:32:48,977 - INFO - Checking if there is a schema change in truncate_load layer
2026-02-05 12:32:48,977 - INFO - Checking if there is a schema change in truncate_load layer
2026-02-05 12:32:48,977 - INFO - Fetching Data Dictionary Table
2026-02-05 12:32:48,977 - INFO - Fetching Data Dictionary Table
Comparing field: country, Current: varchar(100), Expected: varchar(100)
Comparing field: insert_date, Current: timestamp, Expected: timestamp
Comparing field: update_run_id, Current: varchar(50), Expected: varchar(50)
Comparing field: first_name, Current: varchar(100), Expected: varchar(100)
Comparing field: gender, Current: varchar(10), Expected: varchar(10)
Comparing field: insert_run_id, Current: varchar(50), Expected: varchar(50)
Comparing field: last_updated, Current: timestamp, Expected: timestamp
Comparing field: date_of_birth, Current: date, Expected: date
Comparing field: city, Current: varchar(100), Expected: varchar(100)
Comparing field: email, Current: varchar(255), Expected: varchar(255)
Comparing field: last_name, Current: varchar(100), Expected: varchar(100)
Comparing field: update_date, Current: timestamp, Expected: timestamp
Comparing field: student_id, Current: int, Expected: int
Schema change needed check: new_columns=['state'], changed_columns=[], columns_to_drop=[]
Schema change needed: True
2026-02-05 12:33:04,002 - INFO - Schema change detection results for student_info:
2026-02-05 12:33:04,002 - INFO - Schema change detection results for student_info:
2026-02-05 12:33:04,002 - INFO -   - New columns: 1 ['state']
2026-02-05 12:33:04,002 - INFO -   - New columns: 1 ['state']
2026-02-05 12:33:04,002 - INFO -   - Columns with type changes: 0 []
2026-02-05 12:33:04,002 - INFO -   - Columns with type changes: 0 []
2026-02-05 12:33:04,003 - INFO -   - Columns to drop: 0 []
2026-02-05 12:33:04,003 - INFO -   - Columns to drop: 0 []
2026-02-05 12:33:04,003 - INFO -   - Schema change needed: True
2026-02-05 12:33:04,003 - INFO -   - Schema change needed: True
2026-02-05 12:33:04,003 - INFO - Proceeding with schema updates for student_info since enable_dynamic_schema = 'Y'
2026-02-05 12:33:04,003 - INFO - Proceeding with schema updates for student_info since enable_dynamic_schema = 'Y'
2026-02-05 12:33:04,003 - INFO - FORCING SCHEMA UPDATE due to detected differences
2026-02-05 12:33:04,003 - INFO - FORCING SCHEMA UPDATE due to detected differences
Current columns in database: {'student_id': 'int', 'first_name': 'varchar(100)', 'last_name': 'varchar(100)', 'gender': 'varchar(10)', 'date_of_birth': 'date', 'email': 'varchar(255)', 'city': 'varchar(100)', 'country': 'varchar(100)', 'last_updated': 'timestamp', 'insert_date': 'timestamp', 'update_date': 'timestamp', 'insert_run_id': 'varchar(50)', 'update_run_id': 'varchar(50)'}
Found 15 entries in data dictionary
+-------------------+----------+-------------+------------+--------------+---------+---------------+------+---------------+-----+-----------+--------------+--------------+-----------+--------------------------+-----------------------+------------------+----------+----------+
|data_dictionary_key|config_key|schema_name  |table_name  |attribute_name|data_type|execution_layer|length|precision_value|scale|is_not_null|is_primary_key|is_foreign_key|active_flag|insert_date               |update_date            |column_description|created_by|updated_by|
+-------------------+----------+-------------+------------+--------------+---------+---------------+------+---------------+-----+-----------+--------------+--------------+-----------+--------------------------+-----------------------+------------------+----------+----------+
|1                  |3016      |school_bronze|student_info|country       |varchar  |silver         |100   |NULL           |NULL |N          |N             |N             |Y          |NULL                      |2026-01-07 08:57:36.319|country           |User      |User      |
|2                  |3016      |school_bronze|student_info|insert_date   |timestamp|silver         |NULL  |NULL           |NULL |N          |N             |N             |Y          |NULL                      |2026-01-07 08:57:36.367|insert_date       |User      |User      |
|3                  |3016      |school_bronze|student_info|update_run_id |varchar  |silver         |50    |NULL           |NULL |N          |N             |N             |Y          |NULL                      |2026-01-07 08:57:37.196|update_run_id     |User      |User      |
|4                  |3016      |school_bronze|student_info|first_name    |varchar  |silver         |100   |NULL           |NULL |N          |N             |N             |Y          |NULL                      |2026-01-07 08:57:35.302|first_name        |User      |User      |
|5                  |3016      |school_bronze|student_info|gender        |varchar  |silver         |10    |NULL           |NULL |N          |N             |N             |Y          |NULL                      |2026-01-07 08:57:35.296|gender            |User      |User      |
|6                  |3016      |school_bronze|student_info|insert_run_id |varchar  |silver         |50    |NULL           |NULL |N          |N             |N             |Y          |NULL                      |2026-01-07 08:57:36.377|insert_run_id     |User      |User      |
|7                  |3016      |school_bronze|student_info|last_updated  |timestamp|silver         |NULL  |NULL           |NULL |N          |N             |N             |Y          |NULL                      |2026-01-07 08:57:36.39 |last_updated      |User      |User      |
|8                  |3016      |school_bronze|student_info|date_of_birth |date     |silver         |NULL  |NULL           |NULL |N          |N             |N             |Y          |NULL                      |2026-01-07 08:57:33.951|date_of_birth     |User      |User      |
|9                  |3016      |school_bronze|student_info|city          |varchar  |silver         |100   |NULL           |NULL |N          |N             |N             |Y          |NULL                      |2026-01-07 08:57:35.026|city              |User      |User      |
|10                 |3016      |school_bronze|student_info|email         |varchar  |silver         |255   |NULL           |NULL |N          |N             |N             |Y          |NULL                      |2026-01-07 08:57:35.278|email             |User      |User      |
|3231               |3016      |school_silver|student_info|Street        |String   |silver         |10    |NULL           |NULL |N          |N             |N             |Y          |2026-01-07 08:41:04.281894|2026-01-07 08:45:05.372|Street            |API_USER  |API_USER  |
|11                 |3016      |school_bronze|student_info|last_name     |varchar  |silver         |100   |NULL           |NULL |N          |N             |N             |Y          |NULL                      |2026-01-07 08:57:35.317|last_name         |User      |User      |
|12                 |3016      |school_bronze|student_info|update_date   |timestamp|silver         |NULL  |NULL           |NULL |N          |N             |N             |Y          |NULL                      |2026-01-07 08:57:36.386|update_date       |User      |User      |
|13                 |3016      |school_bronze|student_info|student_id    |int      |silver         |NULL  |10             |NULL |Y          |Y             |N             |Y          |NULL                      |2026-01-07 08:57:35.249|student_id        |User      |User      |
|14                 |3016      |school_bronze|student_info|state         |varchar  |silver         |100   |NULL           |NULL |N          |N             |N             |Y          |NULL                      |2026-01-07 08:57:36.09 |state             |User      |User      |
+-------------------+----------+-------------+------------+--------------+---------+---------------+------+---------------+-----+-----------+--------------+--------------+-----------+--------------------------+-----------------------+------------------+----------+----------+

Data dictionary lookup: {'country': {'data_type': 'varchar', 'length': 100, 'precision': None, 'scale': None}, 'insert_date': {'data_type': 'timestamp', 'length': None, 'precision': None, 'scale': None}, 'update_run_id': {'data_type': 'varchar', 'length': 50, 'precision': None, 'scale': None}, 'first_name': {'data_type': 'varchar', 'length': 100, 'precision': None, 'scale': None}, 'gender': {'data_type': 'varchar', 'length': 10, 'precision': None, 'scale': None}, 'insert_run_id': {'data_type': 'varchar', 'length': 50, 'precision': None, 'scale': None}, 'last_updated': {'data_type': 'timestamp', 'length': None, 'precision': None, 'scale': None}, 'date_of_birth': {'data_type': 'date', 'length': None, 'precision': None, 'scale': None}, 'city': {'data_type': 'varchar', 'length': 100, 'precision': None, 'scale': None}, 'email': {'data_type': 'varchar', 'length': 255, 'precision': None, 'scale': None}, 'Street': {'data_type': 'string', 'length': 10, 'precision': None, 'scale': None}, 'last_name': {'data_type': 'varchar', 'length': 100, 'precision': None, 'scale': None}, 'update_date': {'data_type': 'timestamp', 'length': None, 'precision': None, 'scale': None}, 'student_id': {'data_type': 'int', 'length': None, 'precision': 10, 'scale': None}, 'state': {'data_type': 'varchar', 'length': 100, 'precision': None, 'scale': None}}
Columns in data dictionary: {'last_updated', 'insert_date', 'date_of_birth', 'insert_run_id', 'country', 'update_run_id', 'first_name', 'city', 'last_name', 'gender', 'update_date', 'Street', 'student_id', 'email', 'state'}
Comparing country: DB Type=varchar(100), Expected Type=varchar(100)
Comparing insert_date: DB Type=timestamp, Expected Type=timestamp
Comparing update_run_id: DB Type=varchar(50), Expected Type=varchar(50)
Comparing first_name: DB Type=varchar(100), Expected Type=varchar(100)
Comparing gender: DB Type=varchar(10), Expected Type=varchar(10)
Comparing insert_run_id: DB Type=varchar(50), Expected Type=varchar(50)
Comparing last_updated: DB Type=timestamp, Expected Type=timestamp
Comparing date_of_birth: DB Type=date, Expected Type=date
Comparing city: DB Type=varchar(100), Expected Type=varchar(100)
Comparing email: DB Type=varchar(255), Expected Type=varchar(255)
Comparing last_name: DB Type=varchar(100), Expected Type=varchar(100)
Comparing update_date: DB Type=timestamp, Expected Type=timestamp
Comparing student_id: DB Type=int, Expected Type=int
Column to add: state
DETECTED CHANGES:
New columns: ['state']
Changed columns: {}
Columns to drop: []
Ordered columns from data dictionary: ['country', 'insert_date', 'update_run_id', 'first_name', 'gender', 'insert_run_id', 'last_updated', 'date_of_birth', 'city', 'email', 'Street', 'last_name', 'update_date', 'student_id', 'state']
Executing SQL: ALTER TABLE student_info ADD COLUMN state varchar(100) AFTER student_id
Added new column: state
Schema update for table student_info completed. Changes made: True
Transaction committed successfully
Verified columns after update: {'student_id': 'int', 'state': 'varchar(100)', 'first_name': 'varchar(100)', 'last_name': 'varchar(100)', 'gender': 'varchar(10)', 'date_of_birth': 'date', 'email': 'varchar(255)', 'city': 'varchar(100)', 'country': 'varchar(100)', 'last_updated': 'timestamp', 'insert_date': 'timestamp', 'update_date': 'timestamp', 'insert_run_id': 'varchar(50)', 'update_run_id': 'varchar(50)'}
MySQL connection is closed
SCHEMA UPDATE SUCCESS
2026-02-05 12:33:09,652 - INFO - Getting Last Pulled Time
2026-02-05 12:33:09,652 - INFO - Getting Last Pulled Time
max_last_pulled_time = 2026-02-05 12:22:08.485206+00
True
2026-02-05 12:33:10,877 - INFO - There is a change in schema
2026-02-05 12:33:10,877 - INFO - There is a change in schema
2026-02-05 12:33:10,877 - INFO - Adding insert_run_id and update_run_id
2026-02-05 12:33:10,877 - INFO - Adding insert_run_id and update_run_id
+----------+----------+---------+------+-------------+--------------------+---------+--------------+-------+-------------------+--------------------+-------------------+--------------------+--------------------+
|student_id|first_name|last_name|gender|date_of_birth|               email|     city|         state|country|       last_updated|         insert_date|        update_date|       update_run_id|       insert_run_id|
+----------+----------+---------+------+-------------+--------------------+---------+--------------+-------+-------------------+--------------------+-------------------+--------------------+--------------------+
|         1|     Aarav|   Sharma|  Male|   2010-05-14|aarav.sharma@exam...|     Pune|   Maharashtra|  India|2025-11-13 09:43:37|2026-02-05 12:33:...|2025-11-13 09:43:37|manual__2026-02-0...|manual__2026-02-0...|
|         2|      Diya|    Patel|Female|   2011-09-23|diya.patel@exampl...|Ahmedabad|       Gujarat|  India|2025-11-13 09:43:37|2026-02-05 12:33:...|2025-11-13 09:43:37|manual__2026-02-0...|manual__2026-02-0...|
|         3|     Rohan|    Verma|  Male|   2010-03-17|rohan.verma@examp...|    Delhi|         Delhi|  India|2025-11-13 09:43:37|2026-02-05 12:33:...|2025-11-13 09:43:37|manual__2026-02-0...|manual__2026-02-0...|
|         4|     Anaya|     Nair|Female|   2012-07-02|anaya.nair@exampl...|    Kochi|        Kerala|  India|2025-11-13 09:43:37|2026-02-05 12:33:...|2025-11-13 09:43:37|manual__2026-02-0...|manual__2026-02-0...|
|         5|    Vivaan|    Mehta|  Male|   2009-12-11|vivaan.mehta@exam...|   Mumbai|   Maharashtra|  India|2025-11-13 09:43:37|2026-02-05 12:33:...|2025-11-13 09:43:37|manual__2026-02-0...|manual__2026-02-0...|
|         6|      Isha|    Reddy|Female|   2011-02-25|isha.reddy@exampl...|Hyderabad|     Telangana|  India|2025-11-13 09:43:37|2026-02-05 12:33:...|2025-11-13 09:43:37|manual__2026-02-0...|manual__2026-02-0...|
|         7|     Kabir|    Singh|  Male|   2010-08-19|kabir.singh@examp...|   Jaipur|     Rajasthan|  India|2025-11-13 09:43:37|2026-02-05 12:33:...|2025-11-13 09:43:37|manual__2026-02-0...|manual__2026-02-0...|
|         8|     Rahul|    Joshi|  Male|   2010-04-21|rahul.joshi@examp...|   Nagpur|   Maharashtra|  India|2026-02-05 12:04:56|2026-02-05 12:33:...|2026-02-05 12:04:56|manual__2026-02-0...|manual__2026-02-0...|
|         9|     Sneha|    Gupta|Female|   2011-12-05|sneha.gupta@examp...|   Indore|Madhya Pradesh|  India|2026-02-05 12:04:56|2026-02-05 12:33:...|2026-02-05 12:04:56|manual__2026-02-0...|manual__2026-02-0...|
+----------+----------+---------+------+-------------+--------------------+---------+--------------+-------+-------------------+--------------------+-------------------+--------------------+--------------------+

2026-02-05 12:33:11,587 - INFO - Truncating table before writing the data
2026-02-05 12:33:11,587 - INFO - Truncating table before writing the data
2026-02-05 12:33:11,588 - INFO - [truncate_load] Starting table truncation - school_bronze.student_info
2026-02-05 12:33:11,588 - INFO - [truncate_load] Starting table truncation - school_bronze.student_info
2026-02-05 12:33:11,701 - INFO - [truncate_load] Table truncated successfully - school_bronze.student_info
2026-02-05 12:33:11,701 - INFO - [truncate_load] Table truncated successfully - school_bronze.student_info
2026-02-05 12:33:13,527 - INFO - Writing into Audit Table
2026-02-05 12:33:13,527 - INFO - Writing into Audit Table
+----------+-------------+--------------------+-------------+-------------+-----------------+----------------+--------------------+--------------------+------------------+-----------------+-----------------+-------------------+-------+--------------------+
|config_key|    code_name|              run_id|source_system|  schema_name|target_table_name|source_file_name|          start_time|            end_time|inserted_row_count|updated_row_count|deleted_row_count|no_change_row_count| status|    last_pulled_time|
+----------+-------------+--------------------+-------------+-------------+-----------------+----------------+--------------------+--------------------+------------------+-----------------+-----------------+-------------------+-------+--------------------+
|      3016|truncate_load|manual__2026-02-0...|        mysql|school_bronze|     student_info|              NA|2026-02-05 12:32:...|2026-02-05 12:33:...|                 9|                0|                0|                  0|Success|2026-02-05 12:33:...|
+----------+-------------+--------------------+-------------+-------------+-----------------+----------------+--------------------+--------------------+------------------+-----------------+-----------------+-------------------+-------+--------------------+

2026-02-05 12:33:18,159 - INFO - Completed TruncateLoad - student_info student_info
2026-02-05 12:33:18,160 - INFO - Completed TruncateLoad - student_info student_info
2026-02-05 12:33:18,160 - INFO - Completed TruncateLoad - student_info student_info

[2026-02-05T12:33:19.512+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2026-02-05T12:33:19.513+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=Bronze_Dag_1, task_id=Bronze_Dag_1, run_id=manual__2026-02-05T12:31:45.429036+00:00, execution_date=20260205T123145, start_date=20260205T123146, end_date=20260205T123319
[2026-02-05T12:33:19.585+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2026-02-05T12:33:19.610+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
